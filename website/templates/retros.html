<!DOCTYPE html>
<html lang="en">

<head>
    {% include 'default.html' %}
    <meta property="og:title" content="Hab Track - Retros">
    <meta property="og:url" content="https://habtrack.vercel.app/retros">
    <meta property="og:description" content="Browse all tracked Habbo retros">
    <meta property="og:image" content="https://hab-track.vercel.app/img/banner.png">

    <link rel="stylesheet" href="/static/css/retros.css">
</head>

<body>
    <div class="container">
        <div class="retros-header">
            <h1>Habbo Retros Directory</h1>
            <p>Browse all tracked retros and their current status</p>
        </div>

        <div class="search-section">
            <div class="search-input-container">
                <input type="text" id="retro-search" class="search-input" placeholder="Search retros...">
                <div class="search-icon">üîç</div>
            </div>
            <div class="search-stats">
                <span id="active-count">{{ retro_info|length }}</span> active retros
                <span class="separator">‚Ä¢</span>
                <span id="inactive-count">{{ retro_status|length }}</span> inactive retros
            </div>
        </div>

        <div class="retros-content">
            <div class="retros-section">
                <div class="section-header">
                    <h2>
                        <span class="status-indicator active"></span>
                        Active Retros
                    </h2>
                    <span class="section-count" id="active-visible-count">{{ retro_info|length }}</span>
                </div>
                
                <div class="retros-grid" id="active-retros">
                    {% for retro_name, retro_data in retro_info.items()|sort %}
                    <div class="retro-card active" data-name="{{ retro_name.lower() }}">
                        <div class="retro-header">
                            <h3 class="retro-name">{{ retro_name }}</h3>
                            <div class="retro-status">
                                <span class="status-badge active">Active</span>
                            </div>
                        </div>
                        
                        <div class="retro-info">
                            <div class="retro-links">
                                {% if retro_data.retro_info %}
                                    {% if retro_data.retro_info.site %}
                                    <a href="{{ retro_data.retro_info.site }}" target="_blank" class="retro-link site">
                                        <svg class="link-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <line x1="2" y1="12" x2="22" y2="12"></line>
                                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                        </svg>
                                        Retro Site
                                    </a>
                                    {% endif %}

                                    {% if retro_data.retro_info.discord %}
                                    <a href="{{ retro_data.retro_info.discord }}" target="_blank" class="retro-link discord">
                                        <svg class="link-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path
                                                d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z" />
                                        </svg>
                                        Retro Discord
                                    </a>
                                    {% endif %}
                                {% endif %}

                                <a href="https://discord.com/channels/1088116219984478228/{{ retro_data.channel_id }}" target="_blank"
                                    class="retro-link forum">
                                    <svg class="link-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14 2 14 8 20 8"></polyline>
                                        <line x1="16" y1="13" x2="8" y2="13"></line>
                                        <line x1="16" y1="17" x2="8" y2="17"></line>
                                        <polyline points="10 9 9 9 8 9"></polyline>
                                    </svg>
                                    Hab Track Forum
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="retros-section">
                <div class="section-header">
                    <h2>
                        <span class="status-indicator inactive"></span>
                        Inactive Retros
                    </h2>
                    <span class="section-count" id="inactive-visible-count">{{ retro_status|length }}</span>
                </div>
                
                <div class="retros-grid" id="inactive-retros">
                    {% for retro_name, status_data in retro_status.items()|sort %}
                    <div class="retro-card inactive" data-name="{{ retro_name.lower() }}">
                        <div class="retro-header">
                            <h3 class="retro-name">{{ retro_name }}</h3>
                            <div class="retro-status">
                                <span class="status-badge {{ status_data.status.lower() }}">{{ status_data.status }}</span>
                            </div>
                        </div>
                        
                        <div class="retro-info">
                            <div class="retro-meta">
                                <span class="meta-item">
                                    <span class="meta-label">Date:</span>
                                    <span class="meta-value">{{ status_data.date }}</span>
                                </span>
                                
                                {% if status_data.detail %}
                                <span class="meta-item">
                                    <span class="meta-label">Detail:</span>
                                    <span class="meta-value">{{ status_data.detail }}</span>
                                </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="no-results" id="no-results" style="display: none;">
            <div class="no-results-icon">üîç</div>
            <h3>No retros found</h3>
            <p>Can't find the retro you're looking for?</p>
            <p>Please let us know the retro name and we'll add it to our tracking list!</p>
            <a href="/discord" target="_blank" class="button">
                <span>üí¨</span>
                Contact us on Discord
            </a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('retro-search');
            const activeRetros = document.querySelectorAll('#active-retros .retro-card');
            const inactiveRetros = document.querySelectorAll('#inactive-retros .retro-card');
            const noResults = document.getElementById('no-results');
            const activeVisibleCount = document.getElementById('active-visible-count');
            const inactiveVisibleCount = document.getElementById('inactive-visible-count');
            const retrosContent = document.querySelector('.retros-content');

            function updateCounts() {
                const visibleActive = document.querySelectorAll('#active-retros .retro-card:not([style*="display: none"])').length;
                const visibleInactive = document.querySelectorAll('#inactive-retros .retro-card:not([style*="display: none"])').length;
                
                activeVisibleCount.textContent = visibleActive;
                inactiveVisibleCount.textContent = visibleInactive;
                
                const hasResults = visibleActive > 0 || visibleInactive > 0;
                noResults.style.display = hasResults ? 'none' : 'block';
                retrosContent.style.display = hasResults ? 'block' : 'none';
            }

            function filterRetros(searchTerm) {
                const term = searchTerm.toLowerCase().trim();
                
                [...activeRetros, ...inactiveRetros].forEach(card => {
                    const retroName = card.dataset.name;
                    const isVisible = retroName.includes(term);
                    card.style.display = isVisible ? 'block' : 'none';
                });
                
                updateCounts();
            }

            searchInput.addEventListener('input', function() {
                filterRetros(this.value);
            });

            updateCounts();
        });
    </script>
</body>

</html>